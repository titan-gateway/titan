{
  "server": {
    "worker_threads": 4,
    "listen_address": "0.0.0.0",
    "listen_port": 8080,
    "backlog": 128,
    "read_timeout": 60000,
    "write_timeout": 60000,
    "max_connections": 10000,
    "enable_tls": false
  },
  "routes": [
    {
      "path": "/api/public/*",
      "method": "GET",
      "upstream": "backend",
      "middleware": ["public_rate_limit", "public_cors", "api_compression"]
    },
    {
      "path": "/api/premium/*",
      "method": "GET",
      "upstream": "backend",
      "middleware": ["premium_rate_limit", "premium_cors", "api_compression"]
    },
    {
      "path": "/api/internal/*",
      "method": "GET",
      "upstream": "backend",
      "middleware": ["admin_rate_limit", "internal_cors", "strip_prefix_transform"]
    },
    {
      "path": "/static/*",
      "method": "GET",
      "upstream": "cdn",
      "middleware": ["static_compression"]
    },
    {
      "path": "/health",
      "method": "GET",
      "upstream": "backend"
    }
  ],
  "upstreams": [
    {
      "name": "backend",
      "backends": [
        {
          "host": "127.0.0.1",
          "port": 3001,
          "weight": 1,
          "max_connections": 1000
        }
      ],
      "load_balancing": "round_robin"
    },
    {
      "name": "cdn",
      "backends": [
        {
          "host": "127.0.0.1",
          "port": 3002,
          "weight": 1,
          "max_connections": 500
        }
      ],
      "load_balancing": "round_robin"
    }
  ],
  "rate_limits": {
    "public_rate_limit": {
      "enabled": true,
      "requests_per_second": 10,
      "burst_size": 20
    },
    "premium_rate_limit": {
      "enabled": true,
      "requests_per_second": 100,
      "burst_size": 200
    },
    "admin_rate_limit": {
      "enabled": true,
      "requests_per_second": 1000,
      "burst_size": 2000
    }
  },
  "cors_configs": {
    "public_cors": {
      "allowed_origins": ["https://example.com", "https://www.example.com"],
      "allowed_methods": ["GET", "POST"],
      "allowed_headers": ["Content-Type", "Authorization"],
      "allow_credentials": false,
      "max_age": 3600
    },
    "premium_cors": {
      "allowed_origins": ["https://premium.example.com"],
      "allowed_methods": ["GET", "POST", "PUT", "DELETE"],
      "allowed_headers": ["*"],
      "allow_credentials": true,
      "max_age": 7200
    },
    "internal_cors": {
      "allowed_origins": ["https://internal.example.com"],
      "allowed_methods": ["GET", "POST", "PUT", "DELETE", "PATCH"],
      "allowed_headers": ["*"],
      "allow_credentials": true,
      "max_age": 86400
    }
  },
  "transform_configs": {
    "strip_prefix_transform": {
      "enabled": true,
      "path_rewrites": [
        {
          "pattern": "^/api/internal/(.*)$",
          "replacement": "/internal/$1"
        }
      ],
      "request_headers": [
        {
          "action": "add",
          "name": "X-Internal-Request",
          "value": "true"
        }
      ]
    }
  },
  "compression_configs": {
    "api_compression": {
      "enabled": true,
      "algorithms": ["zstd", "gzip", "brotli"],
      "min_size": 1024,
      "level": 6,
      "content_types": ["application/json", "application/xml", "text/plain"]
    },
    "static_compression": {
      "enabled": true,
      "algorithms": ["brotli", "zstd", "gzip"],
      "min_size": 512,
      "level": 9,
      "content_types": ["text/html", "text/css", "application/javascript", "text/plain"],
      "enable_precompressed": true
    }
  },
  "cors": {
    "enabled": false
  },
  "rate_limit": {
    "enabled": false
  },
  "transform": {
    "enabled": false
  },
  "compression": {
    "enabled": false
  },
  "logging": {
    "level": "info",
    "format": "json",
    "output": "/tmp/titan-named-middleware.log"
  },
  "metrics": {
    "enabled": false
  },
  "version": "1.0",
  "description": "Complete named middleware example demonstrating REPLACEMENT model: per-route CORS policies, rate limiting tiers, path transformations, and compression strategies"
}
